<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff</title>
  <link rel="icon" href="images/ico school.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/staff.css">
</head>
<body>
<nav class="navbar" id="navbar">
  <div class="nav-container">
    <div class="nav-logo">
      <img src="images/logo.png" alt="New Cairo STEM School" class="logo">
      <span class="logo-text">New Cairo STEM School</span>
    </div>
    <ul class="nav-menu" id="nav-menu">
      <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
      <li class="nav-item"><a href="About.html" class="nav-link">About</a></li>
      <li class="nav-item"><a href="Academics.html" class="nav-link">Academics & Skills</a></li>
      <li class="nav-item"><a href="Admissions.html" class="nav-link">Admissions</a></li>
      <li class="nav-item"><a href="Acheivments.html" class="nav-link">Students Achievements</a></li>
      <li class="nav-item"><a href="Staff.html" class="nav-link">Staff</a></li>
      <li class="nav-item"><a href="photos.html" class="nav-link">Campus</a></li>
      <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
    </ul>
    <div class="hamburger" id="hamburger">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </div>
  </div>
</nav>

<div class="staff-body">
<h1 class="staff-header">Staff</h1>

<div id="staff-container">
  <!-- هنا السيكشنات والكروت هتظهر ديناميك -->
</div>
</div>

<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <div class="footer-logo">
          <img src="images/logo.png" alt="New Cairo STEM School" class="footer-logo-img">
          <h3>New Cairo STEM School</h3>
        </div>
        <p>Excellence in Science, Technology, Engineering & Mathematics education, preparing students for a bright future in STEM fields.</p>
      </div>
      <div class="footer-section">
        <h4>Quick Links</h4>
        <ul class="footer-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="About.html">About</a></li>
          <li><a href="Academics.html">Academics & Skills</a></li>
          <li><a href="Admissions.html">Admissions</a></li>
          <li><a href="Achievments.html">Students Achievements</a></li>
          <li><a href="Staff.html">Staff</a></li>
          <li><a href="photos.html">Campus</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Contact Info</h4>
        <div class="footer-contact">
          <p><i class="fas fa-map-marker-alt"></i> 
            <a href="https://goo.gl/maps/YOUR_MAP_LINK" target="_blank" style="color: white; text-decoration: none;">New Cairo, Egypt</a>
          </p>
          <p><i class="fas fa-envelope"></i> 
            <a href="mailto:newcairosch@stemnewcairo.moe.edu.eg" style="color: white; text-decoration: none;">newcairosch@stemnewcairo.moe.edu.eg</a>
          </p>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-credits">
        <p>&copy; 2025 New Cairo STEM School. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

<!-- Lightbox Modal -->
<div id="lightbox" class="lightbox">
  <span class="lightbox-close">&times;</span>
  <img class="lightbox-content" id="lightbox-img">
  <div class="lightbox-caption" id="lightbox-caption"></div>
</div>

<script>
// ================= Google Sheet Config =================
const sheetId = "1AHCH7yYFovieVoJAE99plKkBImgd7TXk1Qqgr9NLWbI";
const range = "Form responses"; // Columns: Name, Title, Subject, Info, img url
const apiKey = "AIzaSyCAH2AEtxsa6t4GwoDVjCDIHUq_hhbNbjo";

// ================= Helper Functions =================
function randomDelay() {
    return Math.floor(Math.random() * 700) + 100; // 100-800ms
}

async function fetchSheetData() {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
    const res = await fetch(url);
    if (!res.ok) throw new Error("Failed to fetch Google Sheet data");
    const data = await res.json();
    const [header, ...rows] = data.values;

    // Map rows to objects using header
    return rows.map(row => {
        const obj = {};
        header.forEach((key, i) => obj[key] = row[i] || "");
        return obj;
    });
}

// ================= Generate Staff Sections =================
async function generateStaff() {
    const staffContainer = document.querySelector(".staff-body");
    const rows = await fetchSheetData();

    // Group by Subject
    const subjects = {};
    rows.forEach(({ Name, Title, Subject, Info, "img url": imgUrl }) => {
        if (!subjects[Subject]) subjects[Subject] = [];
        subjects[Subject].push({ name: Name, title: Title, info: Info, imgUrl });
    });

    // Generate HTML for each subject
    for (const [subject, members] of Object.entries(subjects)) {
        const sectionDiv = document.createElement("div");
        sectionDiv.className = "subject-section";

        sectionDiv.innerHTML = `
            <div class="subject">
                <span class="subject-txt">${subject}</span>
            </div>
            <div class="staff-section" id="subject-${subject.replace(/\s+/g, "-")}"></div>
        `;
        staffContainer.appendChild(sectionDiv);

        const sectionBody = sectionDiv.querySelector(".staff-section");

        for (const member of members) {
            await new Promise(res => setTimeout(res, randomDelay()));

            const memberDiv = document.createElement("div");
            memberDiv.className = "staff-member";
            memberDiv.innerHTML = `
                <div class="staff-item" onclick="handleStaffclick(event)">
                    <img src="${member.imgUrl || 'images/placeholder.png'}" alt="${member.name}">
                    <div class="staff-overlay">
                        <h4>${member.name}</h4>
                        <p>${member.title}</p>
                    </div>
                </div>
                <div class="staff-info">
                    ${member.info || "No additional info available."}
                </div>
            `;
            sectionBody.appendChild(memberDiv);
        }
    }
}

// ================= Staff Click Modal =================
function handleStaffclick(e){
  const otherstaffinfo = document.querySelectorAll('.staff-info')
  const otherstaffitem = document.querySelectorAll('.staff-item')
  const otherstaffmember = document.querySelectorAll('.staff-member')


  const object = e.target.closest(".staff-member")
  const staffitem = e.target.closest('.staff-item')
  if(object.classList.contains('active')){
  otherstaffinfo.forEach(item => {item.classList.remove('active')})
  otherstaffitem.forEach(item => {item.classList.remove('active')})
  otherstaffmember.forEach(item => {item.classList.remove('active')})
  } else {

  otherstaffinfo.forEach(item => {item.classList.remove('active')})
  otherstaffitem.forEach(item => {item.classList.remove('active')})
  otherstaffmember.forEach(item => {item.classList.remove('active')})

  staffitem.classList.toggle('active')
  object.classList.toggle('active')
  object.children[1].classList.toggle('active')

  }
}

// ================= Initialize =================
document.addEventListener("DOMContentLoaded", () => {
    generateStaff().catch(err => console.error("Error loading staff:", err));
});


</script>


<script src="script.js"></script>
</body>
</html>
